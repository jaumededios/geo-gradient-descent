<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Geographic optimization sandbox</title>
  </head>
  <body>
    <h1>It's working!</h1>
    <img src = 'compressed.png' style = 'display: none', id = 'height_data'>
  </body>

  <script type="text/javascript"> 	
  	var canvas = false;
  	function get_canvas (){
  		if(canvas) return canvas
	  	var img = document.getElementById('height_data');
		canvas = document.createElement('canvas');
		canvas.width = img.width;
		canvas.height = img.height;
		canvas.getContext('2d').drawImage(img, 0, 0, img.width, img.height);
	}


	function get_pixel(coord){
		var lat = coord[0]; lon = coord[1];
		var w = canvas.width
		var h = canvas.height

		var right = translator.right
		var left = translator.left
		var bottom = translator.bottom
		var top = translator.top

		var px = Math.round((lon-left)/(right-left)*w)
		var py = Math.round((lat-top)/(bottom-top)*w)
		return [px,py]
	}

	function get_coord(pixel){
		var px = coord[0]; py = coord[1];
		var w = canvas.width
		var h = canvas.height

		var right = translator.right
		var left = translator.left
		var bottom = translator.bottom
		var top = translator.top

		var lon = (px+0.)/w*(right-left)+left
		var lat = (py+0.)/h*(bottom-top)+top
		return [lon,lat]
	}

	function get_value(pixel){
		var pixelData = canvas.getContext('2d')
							  .getImageData(pixel[0], pixel[1], 1, 1)
							  .data;
		var  h = translator.height[pixelData[0]]
		var gx = translator.gx[pixelData[1]]
		var gy = translator.gy[pixelData[2]]
		return [h,gx,gy]
	}

	window.onload = function(){
		get_canvas()
		document.body.appendChild(canvas)
	}

	// Hardcoded, this is a baad baad idea
	var translator = {"right": 5.000416715065181, "bottom": 39.999583575446934, "top": 45.00041690878027, "gy": [-523.28, -41.57, -35.36, -31.01, -27.93, -25.55, -23.64, -22.06, -20.67, -19.45, -18.32, -17.26, -16.33, -15.43, -14.66, -13.92, -13.24, -12.59, -12.04, -11.53, -11.03, -10.58, -10.13, -9.7, -9.32, -8.97, -8.61, -8.27, -7.94, -7.67, -7.4, -7.13, -6.89, -6.65, -6.42, -6.22, -6.02, -5.83, -5.66, -5.5, -5.34, -5.18, -5.02, -4.87, -4.73, -4.6, -4.47, -4.35, -4.23, -4.11, -4.0, -3.91, -3.8, -3.71, -3.62, -3.53, -3.43, -3.35, -3.27, -3.19, -3.11, -3.03, -2.95, -2.88, -2.81, -2.74, -2.67, -2.6, -2.53, -2.47, -2.41, -2.35, -2.29, -2.23, -2.17, -2.11, -2.05, -2.0, -1.94, -1.89, -1.84, -1.78, -1.73, -1.68, -1.63, -1.57, -1.53, -1.48, -1.43, -1.39, -1.34, -1.29, -1.25, -1.2, -1.16, -1.12, -1.07, -1.03, -0.99, -0.95, -0.91, -0.87, -0.83, -0.8, -0.76, -0.72, -0.69, -0.65, -0.62, -0.58, -0.55, -0.51, -0.48, -0.45, -0.42, -0.39, -0.36, -0.33, -0.3, -0.27, -0.25, -0.22, -0.19, -0.17, -0.15, -0.12, -0.1, -0.08, -0.07, -0.05, -0.03, -0.01, -0.0, 0.0, 0.01, 0.03, 0.04, 0.06, 0.08, 0.1, 0.11, 0.13, 0.15, 0.18, 0.2, 0.22, 0.24, 0.26, 0.29, 0.31, 0.34, 0.37, 0.39, 0.42, 0.45, 0.48, 0.51, 0.54, 0.57, 0.6, 0.64, 0.67, 0.71, 0.74, 0.78, 0.82, 0.86, 0.9, 0.94, 0.99, 1.03, 1.07, 1.12, 1.17, 1.22, 1.27, 1.32, 1.37, 1.42, 1.47, 1.53, 1.59, 1.64, 1.69, 1.75, 1.81, 1.87, 1.94, 2.0, 2.07, 2.13, 2.2, 2.27, 2.34, 2.41, 2.49, 2.56, 2.63, 2.71, 2.79, 2.88, 2.96, 3.04, 3.13, 3.22, 3.32, 3.42, 3.52, 3.63, 3.75, 3.86, 3.98, 4.1, 4.22, 4.36, 4.5, 4.64, 4.79, 4.94, 5.1, 5.27, 5.44, 5.64, 5.84, 6.07, 6.3, 6.54, 6.79, 7.06, 7.37, 7.68, 8.03, 8.38, 8.72, 9.08, 9.5, 9.95, 10.44, 10.93, 11.5, 12.08, 12.75, 13.49, 14.23, 15.06, 16.01, 17.09, 18.32, 19.55, 20.95, 22.47, 24.38, 26.82, 30.01, 35.23, 987.42], "gx": [-515.14, -32.05, -26.22, -22.66, -20.2, -18.29, -16.86, -15.63, -14.56, -13.66, -12.87, -12.15, -11.5, -10.97, -10.42, -9.94, -9.49, -9.04, -8.64, -8.28, -7.93, -7.63, -7.34, -7.08, -6.82, -6.58, -6.33, -6.1, -5.87, -5.66, -5.45, -5.26, -5.07, -4.89, -4.72, -4.56, -4.42, -4.27, -4.14, -4.0, -3.88, -3.77, -3.66, -3.55, -3.45, -3.35, -3.26, -3.17, -3.08, -3.0, -2.92, -2.84, -2.76, -2.69, -2.63, -2.56, -2.49, -2.43, -2.37, -2.31, -2.25, -2.19, -2.14, -2.08, -2.02, -1.97, -1.92, -1.86, -1.82, -1.77, -1.72, -1.67, -1.63, -1.58, -1.54, -1.49, -1.45, -1.41, -1.37, -1.33, -1.29, -1.25, -1.21, -1.18, -1.14, -1.1, -1.06, -1.03, -0.99, -0.96, -0.92, -0.89, -0.86, -0.82, -0.79, -0.76, -0.73, -0.69, -0.66, -0.63, -0.6, -0.57, -0.54, -0.51, -0.48, -0.45, -0.43, -0.4, -0.37, -0.35, -0.32, -0.3, -0.28, -0.26, -0.23, -0.21, -0.19, -0.17, -0.15, -0.13, -0.11, -0.09, -0.08, -0.06, -0.05, -0.03, -0.02, -0.01, 0.0, 0.0, 0.01, 0.02, 0.04, 0.05, 0.06, 0.08, 0.09, 0.11, 0.13, 0.14, 0.16, 0.18, 0.2, 0.22, 0.24, 0.26, 0.28, 0.31, 0.33, 0.35, 0.38, 0.41, 0.44, 0.46, 0.49, 0.52, 0.55, 0.58, 0.62, 0.65, 0.68, 0.71, 0.75, 0.78, 0.81, 0.85, 0.88, 0.91, 0.95, 0.99, 1.02, 1.06, 1.09, 1.13, 1.17, 1.21, 1.25, 1.29, 1.33, 1.36, 1.41, 1.45, 1.49, 1.54, 1.58, 1.62, 1.67, 1.71, 1.76, 1.81, 1.86, 1.91, 1.97, 2.02, 2.07, 2.13, 2.18, 2.24, 2.3, 2.36, 2.42, 2.49, 2.55, 2.62, 2.69, 2.76, 2.83, 2.91, 2.99, 3.06, 3.15, 3.23, 3.32, 3.42, 3.51, 3.6, 3.7, 3.81, 3.93, 4.05, 4.18, 4.31, 4.45, 4.59, 4.74, 4.9, 5.07, 5.25, 5.45, 5.63, 5.83, 6.06, 6.31, 6.56, 6.84, 7.14, 7.47, 7.81, 8.19, 8.59, 9.02, 9.5, 10.07, 10.63, 11.29, 12.1, 12.94, 13.84, 14.94, 16.23, 17.86, 19.67, 22.05, 25.48, 30.74, 512.58], "height": [-1000.0, -3.75, -0.95, -0.05, 1.0, 2.58, 4.83, 7.94, 11.48, 16.42, 21.51, 26.63, 30.26, 33.26, 37.41, 41.04, 44.96, 48.19, 51.45, 55.06, 58.63, 62.02, 65.28, 68.56, 72.38, 75.83, 78.95, 82.07, 85.48, 88.61, 91.53, 94.27, 96.8, 99.36, 101.85, 104.54, 107.35, 110.05, 112.6, 114.94, 117.21, 119.48, 122.06, 124.48, 126.82, 128.96, 131.13, 133.03, 134.92, 137.06, 139.35, 141.56, 143.51, 145.71, 147.81, 149.59, 151.61, 153.47, 155.55, 157.59, 159.6, 161.78, 163.87, 166.02, 168.18, 170.27, 172.25, 174.35, 176.43, 178.52, 180.63, 182.67, 184.93, 187.14, 189.44, 191.59, 193.79, 196.01, 198.26, 200.34, 202.68, 204.94, 207.24, 209.73, 212.12, 214.55, 216.87, 219.28, 221.65, 223.94, 226.22, 228.42, 230.82, 233.24, 235.66, 237.98, 240.2, 242.59, 244.96, 247.4, 249.93, 252.47, 255.12, 257.68, 260.34, 263.05, 265.99, 268.69, 271.61, 274.13, 276.81, 279.4, 282.27, 285.37, 288.35, 291.47, 294.91, 298.41, 301.63, 305.19, 308.66, 312.18, 315.75, 319.2, 322.59, 326.17, 329.96, 334.12, 338.01, 342.32, 346.77, 351.19, 355.4, 359.61, 364.42, 369.21, 374.05, 379.0, 384.34, 389.16, 394.22, 399.8, 405.11, 410.65, 415.81, 421.34, 426.96, 433.41, 439.65, 445.78, 452.62, 458.63, 464.36, 470.27, 476.06, 481.99, 488.21, 493.86, 500.11, 506.19, 512.59, 519.45, 525.92, 532.44, 539.15, 545.92, 552.02, 558.03, 564.19, 570.34, 576.35, 582.63, 588.8, 594.87, 601.32, 607.55, 613.57, 619.86, 626.09, 632.57, 639.31, 645.86, 652.36, 659.1, 665.88, 673.12, 680.27, 687.16, 695.27, 703.99, 712.53, 720.57, 729.5, 738.32, 747.73, 756.87, 765.22, 775.12, 785.83, 796.34, 805.7, 815.29, 825.82, 836.25, 847.72, 859.35, 870.46, 881.26, 892.96, 904.18, 914.05, 926.08, 937.95, 949.49, 960.53, 972.03, 984.31, 998.53, 1012.21, 1026.34, 1040.92, 1055.62, 1068.86, 1082.46, 1096.68, 1115.48, 1131.03, 1148.94, 1167.21, 1184.39, 1201.33, 1216.13, 1237.41, 1257.22, 1281.27, 1305.93, 1335.51, 1368.2, 1403.64, 1441.88, 1481.22, 1527.53, 1574.39, 1627.51, 1681.0, 1737.96, 1798.71, 1868.83, 1941.35, 2010.07, 2088.72, 2168.72, 2249.55, 2372.18, 2524.05, 2956.85], "left": -0.0004166182681528685}
  </script>
</html>